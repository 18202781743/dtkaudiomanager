# 检测音频设备是否在线


## 引入audiomanager，可查看audiomanager-example示例
- 在qmake管理的项目*.pro工程文件里添加`audiomanager`模块引用

```pro
QT += audiomanager
```

- 在cmake管理的项目CMakeLists.txt文件里添加

```CMakeLists.txt
find_package(audiomanager)
target_include_directories(${PROJECT_NAME} PUBLIC ${dtkaudiomanager_INCLUDE_DIR})
target_include_directories(${PROJECT_NAME} PUBLIC ${dtkaudiomanager_LIBRARIES})
```

## Qt使用DAudioManager监听端口改变
```
#include <QCoreApplication>
#include <DAudioManager>
#include <QDebug>

AUDIOMANAGER_USE_NAMESPACE;
void printCard(const DAudioCard *card)
{
    qInfo() << card->name() << card->id();
    qInfo() << "Ports size:" << card->ports().size();
    for (auto port : card->ports()) {
        qInfo() << port->name() << port->description() << port->direction() << port->available();
    }
}

void printCards(const DAudioManager &manager)
{
    auto cards = manager.cards();
    qInfo() << "Cards size:" << cards.count();
    for (auto card : cards) {
        printCard(card.data());
    }
}
int main(int argc, char *argv[])
{
    QCoreApplication app(argc, argv);
    DAudioManager manager;

    QObject::connect(&manager, &DAudioManager::cardAdded, [&manager](quint32 idx){
        qInfo() << "----------cardAdded----------" << idx;
        if (auto card = manager.cardById(idx)) {
            printCard(card.data());
        }
    });

    QObject::connect(&manager, &DAudioManager::cardRemoved, [&manager](quint32 idx){
        qInfo() << "----------cardRemoved----------" << idx;
        printCards(manager);
    });

    QObject::connect(&manager, &DAudioManager::cardUpdated, [&manager](quint32 idx){
        qInfo() << "----------cardUpdated----------" << idx;
        if (auto card = manager.cardById(idx)) {
            printCard(card.data());
        }
    });

    printCards(manager);
    return app.exec();
}

```

## 检测
插拔设备，上述代码打印出声卡设备信息，及声卡所对应的端口列表。
